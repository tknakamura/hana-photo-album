# 家族アルバムサイト UI/UX 構成案（スマホ中心 / Render + R2）

## 1. コンセプト概要

* **目的:** 家族全員がスマホから簡単に思い出をアップロード・閲覧できるアルバム。
* **対象:** 親世代・子世代・祖父母まで幅広く使える直感UI。
* **デザインキーワード:** 「あたたかい」「簡単」「見やすい」「安心」。

---

## 2. ナビゲーション構造（スマホ想定）

### 下部固定タブバー

```
---------------------------------
| 🏠 ホーム | 🖼 アルバム | ⬆️ アップ | ⚙️ 設定 |
---------------------------------
```

* ホーム：最近のアップロード、季節ごとの思い出を表示
* アルバム：イベントや期間ごとに整理されたアルバム一覧
* アップ：写真・動画のアップロードページ
* 設定：家族メンバー管理、ストレージ容量など

### 上部バー

```
--------------------------------------------------
| 家族アルバム 👨‍👩‍👧‍👦 | 🔍 検索 | 👤 プロフィール |
--------------------------------------------------
```

---

## 3. 各画面ワイヤーフレーム（スマホ縦向き）

### (1) ホーム（初期表示）

```
┌─────────────────────────────┐
│ 家族アルバム 👨‍👩‍👧‍👦                         🔍 │
├─────────────────────────────┤
│ 📅 最近のアップロード                         │
│ [2025年10月] 子どもの運動会 🎽               │
│   🖼 🖼 🖼                                      │
│                                                │
│ 📂 アルバムピックアップ                       │
│  ▢ 夏の思い出 ☀️ (45枚)                      │
│  ▢ 家族旅行 in 沖縄 🌴 (83枚)               │
└─────────────────────────────┘
```

* スクロールで無限ロード。
* サムネイルは2列グリッド。
* 直感的に「押して拡大」「スワイプで次へ」。

---

### (2) アルバム一覧

```
┌─────────────────────────────┐
│ < 戻る  アルバム一覧                        ＋│
├─────────────────────────────┤
│  ▢ 夏の思い出 ☀️ (2024) [📸120枚]           │
│  ▢ 家族旅行 in 沖縄 🌴 (2023) [📸85枚]      │
│  ▢ 子どもの運動会 🎽 (2025) [📸45枚]        │
└─────────────────────────────┘
```

* 各アルバムは1行カード形式（カバー＋タイトル＋枚数）。
* スワイプで削除、長押しで並べ替え。

---

### (3) アルバム詳細

```
┌─────────────────────────────┐
│ < 戻る  夏の思い出 ☀️  [共有]               │
├─────────────────────────────┤
│ 📖 「2024年の夏休みの思い出です」           │
│---------------------------------------------│
│  🖼🖼                                        │
│  🖼🖼                                        │
│  🖼🖼                                        │
│---------------------------------------------│
│ [+ 写真を追加]                              │
└─────────────────────────────┘
```

* サムネは2列グリッド。スワイプでページング。
* 共有は家族限定URL発行。

---

### (4) 写真・動画アップロード

```
┌─────────────────────────────┐
│ < 戻る  写真・動画を追加                    │
├─────────────────────────────┤
│ [📂 ファイルを選択] または [📸 撮影する]    │
│---------------------------------------------│
│ ✅ IMG_001.jpg   100% 完了                   │
│ ⏳ IMG_002.mov   45%                         │
│---------------------------------------------│
│ [アップロード開始] ボタン                    │
└─────────────────────────────┘
```

* スマホカメラから直接アップ可能。
* アップ中はプログレスバーをリアルタイム表示。

---

### (5) 画像・動画閲覧UI（フルスクリーンビュー）

```
┌──────────────────────────────────┐
│ ← 戻る   2025/08/15 12:32      ↗ 共有      │
├──────────────────────────────────┤
│        [フルスクリーン画像 or 動画]         │
│  ・ピンチズーム / ダブルタップで拡大縮小     │
│  ・左右スワイプで前後メディアに切替         │
│  ・動画: ▶️再生 / ⏸停止 / ⏩速度 / 🔈音量     │
├──────────────────────────────────┤
│ 🔔 [リアクションバー] ❤️ 👍 😍 😢 🎉（長押しで追加）│
│----------------------------------------------│
│ 💬 コメント                                  │
│  ┌──────────────────────────────────────┐   │
│  │  👤 ママ  12:31  「この日暑かったね！」   │ … │
│  │   ↪ 返信  ❤️5   …                       │   │
│  └──────────────────────────────────────┘   │
│  （下にスクロールで過去コメントをLazy Load）  │
│----------------------------------------------│
│ ✍️ コメント入力                              │
│  ┌──────────────────────────────────────┐   │
│  │  [@名前] を入力…  （140字まで）         │   │
│  │  [📎 画像] [😊 スタンプ] [🎤 音声]       │   │
│  └───────────────┬──────────────┘   │
│                    [送信 ▶]（右下固定）      │
└──────────────────────────────────┘
```

**コメント入力UIのふるまい**

* **固定コンポーザー**：下部固定。キーボード展開時はメディア部を縮めて視界を確保。
* **送信**：`送信▶`タップで**楽観的UI**（即時表示→非同期確定）。失敗時はエラートースト＋再送アイコン。
* **メンション**：`@`入力で家族メンバー候補をポップ。タップで挿入＆軽いハイライト。
* **引用返信**：任意のコメントを右スワイプor長押し→「返信」選択で、上部に引用チップ表示。
* **リアクション**：コメント長押し→絵文字ピッカー。直近使用を先頭に表示。
* **編集/削除**：自分のコメントのみ「…」メニューに表示（ロールに応じた削除権限）。
* **スクロール挙動**：最新へジャンプボタン（⬇）。履歴はインフィニティ・スクロールで遡及読み込み。
* **アクセシビリティ**：送信ボタンは48px角以上、VoiceOverの読み順最適化、コントラスト比4.5:1以上。

---

## 4. デザインスタイル

| 要素          | スタイル                            |
| ----------- | ------------------------------- |
| 背景          | #FAFAF8（暖かいアイボリー）               |
| 主要カラー       | パステルピンク / スカイブルー / サンドベージュ      |
| フォント        | Noto Sans JP + Inter（16px〜18px） |
| ボタン         | 丸角（radius: 16px）、大きめタップ領域       |
| アイコン        | Lucide / Heroicons、線の太さ統一       |
| アニメーション     | 0.2s〜0.3s のフェード/スライド            |
| メディアトランジション | クロスフェード＋スライドトランジション             |

---

## 5. UXのキーポイント

1. **スマホ片手操作最適化**：主要ボタンを画面下部に配置。
2. **アップロードを最短3タップに**：［＋］→カメラ→完了。
3. **スムーズな閲覧体験**：プリロード＋スワイプ遷移でストレスフリー。
4. **コメントUX**：感情の共有を促すミニチャットUI（写真ごとに紐付け）。
5. **シニアにも優しい**：ボタン間隔広め、コントラスト高め。
6. **通信負荷対策**：WebP/AVIF＋HLSで最適化。

---

## コメント追加のUI/UX（詳細）

### 1) コメントの種類

* **通常コメント**：テキスト中心。140〜300字目安（設定で変更可）。
* **返信（スレッド）**：1段ネスト（無限ネストは避ける）。親コメントの一部を引用表示。
* **スタンプ/絵文字**：送信欄の😊から挿入。テキストと混在可。
* **音声コメント（任意）**：🎤長押しで録音→サーバへアップ。可視化に波形バー。

### 2) 送信フロー

1. 入力→`送信`タップ→**楽観的追加**（灰色プレースホルダー＋スケルトン）
2. バックエンドへPOST（`family_id`スコープ、NGワード/長さ検証）
3. 成功→タイムスタンプ確定・ID付与。失敗→エラートースト＋再送アイコン表示。

### 3) 権限とモデレーション

* **可視範囲**：`family_id`内のみ。
* **編集・削除**：本人は一定時間内編集可（例：5分）。`admin/parent`は削除可。
* **通報**：長押しメニューに「報告」。管理画面でレビュー可能に。
* **スパム防止**：1ユーザーあたりの**レート制限**（例：10件/分）、連投時のクールダウン。

### 4) 通知

* **メンション通知**：`@`でプッシュ/メール（任意）。
* **返信通知**：自分のコメントに対する返信時。
* **サイレント投稿**（任意）：通知を送らず記録だけする切替。

### 5) エッジケース/エラー

* **オフライン**：コンポーザーに「オフライン」インジケータ。ローカルキュー→再接続で自動送信。
* **画像/動画閲覧中のキーボード**：コンポーザー固定、上部にメディアが押し上げられないよう**安全領域**に収める。
* **長文折りたたみ**：3行超は`もっと見る`展開。
* **国際化**：改行・句読点の扱い最適化。絵文字は1グリフ扱い。

### 6) API スキーマ（コメント）

```sql
comments(
  id uuid pk,
  family_id uuid not null,
  photo_id uuid not null,
  parent_id uuid null,         -- 返信時のみ
  author_user_id uuid not null,
  body text not null,          -- プレーンテキスト（後で装飾）
  body_rich jsonb null,        -- メンション/絵文字の装飾情報
  reactions jsonb default '[]',-- [{emoji:"❤️", user_id:"..."}]
  created_at timestamptz default now(),
  updated_at timestamptz
);
create index if not exists idx_comments_photo on comments(photo_id, created_at desc);
```

### 7) イベント計測（例）

* `comment_send_attempt` / `comment_send_success` / `comment_send_failed`
* `comment_mention_used` / `comment_reaction_added`
* `comment_reply_opened`（スレッド展開）

---

## 6. 次ステップ

* [ ] コメントコンポーザーのUI実装（入力・送信・失敗再送）
* [ ] 返信（1段スレッド）とリアクションの実装
* [ ] メンション候補ポップの実装（家族メンバーAPI）
* [ ] オフラインキューと楽観的UIの実装
* [ ] 通知（メンション/返信）フローの実装
